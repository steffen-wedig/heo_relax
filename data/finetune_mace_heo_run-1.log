2025-05-14 08:55:14.263 INFO: ===========VERIFYING SETTINGS===========
2025-05-14 08:55:14.264 INFO: MACE version: 0.3.13
2025-05-14 08:55:14.458 INFO: CUDA version: 12.6, CUDA device: 0
2025-05-14 08:55:14.852 INFO: Using foundation model mace-mp-0 medium as initial checkpoint.
2025-05-14 08:55:16.296 INFO: CUDA version: 12.6, CUDA device: 0
2025-05-14 08:55:16.302 INFO: ===========LOADING INPUT DATA===========
2025-05-14 08:55:16.302 INFO: Using heads: ['Default']
2025-05-14 08:55:16.302 INFO: Using the key specifications to parse data:
2025-05-14 08:55:16.302 INFO: Default: KeySpecification(info_keys={'energy': 'DFT_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'DFT_forces', 'charges': 'REF_charges'})
2025-05-14 08:55:16.303 INFO: =============    Processing head Default     ===========
2025-05-14 08:55:17.935 INFO: Training set 1/1 [energy: 4524, stress: 0, virials: 0, dipole components: 0, head: 4524, forces: 4524, charges: 0]
2025-05-14 08:55:17.954 INFO: Total Training set [energy: 4524, stress: 0, virials: 0, dipole components: 0, head: 4524, forces: 4524, charges: 0]
2025-05-14 08:55:18.350 INFO: Validation set 1/1 [energy: 1292, stress: 0, virials: 0, dipole components: 0, head: 1292, forces: 1292, charges: 0]
2025-05-14 08:55:18.355 INFO: Total Validation set [energy: 1292, stress: 0, virials: 0, dipole components: 0, head: 1292, forces: 1292, charges: 0]
2025-05-14 08:55:18.355 INFO: Total number of configurations: train=4524, valid=1292, tests=[],
2025-05-14 08:55:18.374 INFO: Atomic Numbers used: [3, 4, 8, 11, 12, 13, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 37, 38, 39, 40, 41, 42, 44, 45, 46, 47, 48, 49, 50, 55, 56, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 90, 92, 94]
2025-05-14 08:55:18.376 INFO: Atomic Energies used (z: eV) for head Default: {3: -3.482100566595956, 4: -4.736697230897597, 8: -7.28459863421322, 11: -2.7593613569762425, 12: -2.814047612069227, 13: -4.846881245288104, 19: -2.6176454856894793, 20: -5.390461060484104, 21: -7.8857952163517675, 22: -10.268392986214433, 23: -8.665147785496703, 24: -9.233050763772013, 25: -8.304951520770791, 26: -7.0489865771593765, 27: -5.577439766222147, 28: -5.172747618813715, 29: -3.2520726958619472, 30: -1.2901611618726314, 31: -3.527082192997912, 37: -2.5634958965928316, 38: -4.938005211501922, 39: -10.149818838085771, 40: -11.846857579882572, 41: -12.138896361658485, 42: -8.791678800595722, 44: -7.78093221529871, 45: -6.850021409115055, 46: -4.891019073240479, 47: -2.0634296773864045, 48: -0.6395695518943755, 49: -2.7887442084286693, 50: -3.818604275441892, 55: -2.765284507132287, 56: -4.990956432167774, 57: -8.933684809576345, 58: -8.735591176647514, 59: -8.018966025544966, 60: -8.251491970213372, 62: -8.169659881166858, 63: -13.592664636171698, 64: -18.517523458456985, 65: -7.647396572993602, 66: -8.122981037851925, 67: -7.607787319678067, 68: -6.85029094445494, 69: -7.8268821327130365, 70: -3.584786591677161, 71: -7.455406192077973, 72: -12.796283502572146, 73: -14.108127281277586, 74: -9.354916969477486, 75: -11.387537567890853, 76: -9.621909492152557, 77: -7.324393429417677, 78: -5.3046964808341945, 79: -2.380092582080244, 80: 0.24948924158195362, 81: -2.3239789120665026, 82: -3.730042357127322, 83: -3.438792347649683, 90: -11.02462566385297, 92: -13.855648206100362, 94: -15.282826131998245}
2025-05-14 08:55:18.377 INFO: Processing datasets for head 'Default'
2025-05-14 08:55:24.040 INFO: Combining 1 list datasets for head 'Default'
2025-05-14 08:55:25.635 INFO: Combining 1 list datasets for head 'Default_valid'
2025-05-14 08:55:25.636 INFO: Combined validation datasets for Default
2025-05-14 08:55:25.636 INFO: Head 'Default' training dataset size: 4524
2025-05-14 08:55:25.636 INFO: Computing average number of neighbors
2025-05-14 08:55:27.484 INFO: Average number of neighbors: 65.10629466114423
2025-05-14 08:55:27.484 INFO: During training the following quantities will be reported: energy, forces
2025-05-14 08:55:27.484 INFO: ===========MODEL DETAILS===========
2025-05-14 08:55:29.191 INFO: Loading FOUNDATION model
2025-05-14 08:55:29.192 INFO: Using filtered elements: [3, 4, 8, 11, 12, 13, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 37, 38, 39, 40, 41, 42, 44, 45, 46, 47, 48, 49, 50, 55, 56, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 90, 92, 94]
2025-05-14 08:55:29.192 INFO: Model configuration extracted from foundation model
2025-05-14 08:55:29.192 INFO: Using universal loss function for fine-tuning
2025-05-14 08:55:29.192 INFO: Message passing with hidden irreps 128x0e+128x1o)
2025-05-14 08:55:29.192 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-05-14 08:55:29.193 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-05-14 08:55:29.193 INFO: Distance transform for radial basis functions: None
2025-05-14 08:55:30.799 INFO: Total number of parameters: 3453978
2025-05-14 08:55:30.799 INFO: 
2025-05-14 08:55:30.799 INFO: ===========OPTIMIZER INFORMATION===========
2025-05-14 08:55:30.799 INFO: Using ADAM as parameter optimizer
2025-05-14 08:55:30.799 INFO: Batch size: 5
2025-05-14 08:55:30.799 INFO: Number of gradient updates: 9048
2025-05-14 08:55:30.799 INFO: Learning rate: 0.0001, weight decay: 5e-07
2025-05-14 08:55:30.799 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2025-05-14 08:55:30.800 INFO: Converting model to CUEQ for accelerated training
2025-05-14 08:55:30.877 INFO: Creating new model with cuequivariance settings
2025-05-14 08:55:34.641 INFO: Using gradient clipping with tolerance=10.000
2025-05-14 08:55:34.641 INFO: 
2025-05-14 08:55:34.641 INFO: ===========TRAINING===========
2025-05-14 08:55:34.642 INFO: Started training, reporting errors on validation set
2025-05-14 08:55:34.642 INFO: Loss metrics on validation set
2025-05-14 08:55:45.727 INFO: Initial: head: Default, loss=0.00844525, RMSE_E_per_atom=   65.65 meV, RMSE_F=   88.45 meV / A
2025-05-14 08:57:15.138 INFO: Epoch 0: head: Default, loss=0.00512485, RMSE_E_per_atom=   73.04 meV, RMSE_F=   67.31 meV / A
2025-05-14 08:58:13.319 INFO: Epoch 1: head: Default, loss=0.00499883, RMSE_E_per_atom=   74.90 meV, RMSE_F=   66.04 meV / A
2025-05-14 08:59:11.439 INFO: Epoch 2: head: Default, loss=0.00483945, RMSE_E_per_atom=   74.87 meV, RMSE_F=   64.77 meV / A
2025-05-14 09:00:09.554 INFO: Epoch 3: head: Default, loss=0.00491328, RMSE_E_per_atom=   76.00 meV, RMSE_F=   65.05 meV / A
2025-05-14 09:01:07.436 INFO: Epoch 4: head: Default, loss=0.00511088, RMSE_E_per_atom=   77.02 meV, RMSE_F=   66.38 meV / A
2025-05-14 09:02:05.343 INFO: Epoch 5: head: Default, loss=0.00507026, RMSE_E_per_atom=   76.15 meV, RMSE_F=   66.22 meV / A
2025-05-14 09:03:03.236 INFO: Epoch 6: head: Default, loss=0.00510720, RMSE_E_per_atom=   76.51 meV, RMSE_F=   66.33 meV / A
2025-05-14 09:04:01.229 INFO: Epoch 7: head: Default, loss=0.00518606, RMSE_E_per_atom=   76.38 meV, RMSE_F=   66.92 meV / A
2025-05-14 09:04:59.461 INFO: Epoch 8: head: Default, loss=0.00537366, RMSE_E_per_atom=   77.01 meV, RMSE_F=   68.09 meV / A
2025-05-14 09:05:57.589 INFO: Epoch 9: head: Default, loss=0.00530328, RMSE_E_per_atom=   76.46 meV, RMSE_F=   67.72 meV / A
2025-05-14 09:05:57.589 INFO: Training complete
2025-05-14 09:05:57.589 INFO: 
2025-05-14 09:05:57.589 INFO: ===========RESULTS===========
2025-05-14 09:05:57.591 INFO: Loading checkpoint: ./checkpoints/finetune_mace_heo_run-1_epoch-2.pt
2025-05-14 09:05:57.648 INFO: Loaded Stage one model from epoch 2 for evaluation
2025-05-14 09:05:57.648 INFO: Saving model to checkpoints/finetune_mace_heo_run-1.model
2025-05-14 09:05:57.814 INFO: Creating new model without CuEq settings
2025-05-14 09:05:59.306 INFO: Compiling model, saving metadata to finetune_mace_heo_compiled.model
2025-05-14 09:06:00.143 INFO: Computing metrics for training, validation, and test sets
2025-05-14 09:06:00.144 INFO: Skipping evaluation for heads: ['pt_head']
2025-05-14 09:06:00.144 INFO: Evaluating train_Default ...
2025-05-14 09:06:42.581 INFO: Evaluating valid_Default ...
2025-05-14 09:06:46.951 INFO: Error-table on TRAIN and VALID:
+---------------+---------------------+------------------+-------------------+
|  config_type  | RMSE E / meV / atom | RMSE F / meV / A | relative F RMSE % |
+---------------+---------------------+------------------+-------------------+
| train_Default |           75.4      |         48.0     |        120.02     |
| valid_Default |           74.9      |         64.8     |         40.32     |
+---------------+---------------------+------------------+-------------------+
2025-05-14 09:07:49.505 INFO: Done
